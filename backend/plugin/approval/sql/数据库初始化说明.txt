==================================================
å®¡æ‰¹æµæ’ä»¶ - å¤šæ•°æ®åº“æ”¯æŒè¯´æ˜
==================================================

ğŸ“¦ æ”¯æŒçš„æ•°æ®åº“
==================================================

âœ… MySQL 5.7+ / MariaDB 10.2+
âœ… PostgreSQL 12+
âœ… SQLite 3.31+

==================================================
ğŸ“ æ–‡ä»¶ç»“æ„
==================================================

backend/plugin/approval/sql/
â”œâ”€â”€ mysql/
â”‚   â””â”€â”€ init.sql         # MySQLåˆå§‹åŒ–è„šæœ¬
â”œâ”€â”€ postgresql/
â”‚   â””â”€â”€ init.sql         # PostgreSQLåˆå§‹åŒ–è„šæœ¬
â””â”€â”€ sqlite/
    â””â”€â”€ init.sql         # SQLiteåˆå§‹åŒ–è„šæœ¬

==================================================
ğŸš€ MySQL ä½¿ç”¨æ–¹æ³•
==================================================

æ–¹æ³•ä¸€ï¼šå‘½ä»¤è¡Œ
--------------------------------------------------
cd backend/plugin/approval/sql/mysql
mysql -u root -p database_name < init.sql

æ–¹æ³•äºŒï¼šæ•°æ®åº“å®¢æˆ·ç«¯
--------------------------------------------------
1. æ‰“å¼€ Navicat / DBeaver / phpMyAdmin
2. è¿æ¥åˆ° MySQL æ•°æ®åº“
3. æ‰“å¼€ mysql/init.sql
4. æ‰§è¡Œè„šæœ¬

ç‰¹æ€§ï¼š
- ä½¿ç”¨ BIGINT AUTO_INCREMENT ä½œä¸ºä¸»é”®
- ä½¿ç”¨ JSON ç±»å‹å­˜å‚¨å¤æ‚æ•°æ®
- ä½¿ç”¨ TIMESTAMP ç±»å‹å­˜å‚¨æ—¶é—´
- æ”¯æŒ utf8mb4 å­—ç¬¦é›†

==================================================
ğŸš€ PostgreSQL ä½¿ç”¨æ–¹æ³•
==================================================

æ–¹æ³•ä¸€ï¼šå‘½ä»¤è¡Œ
--------------------------------------------------
cd backend/plugin/approval/sql/postgresql
psql -U postgres -d database_name -f init.sql

æ–¹æ³•äºŒï¼špgAdmin / DataGrip
--------------------------------------------------
1. æ‰“å¼€ pgAdmin æˆ– DataGrip
2. è¿æ¥åˆ° PostgreSQL æ•°æ®åº“
3. æ‰“å¼€ postgresql/init.sql
4. æ‰§è¡Œè„šæœ¬

ç‰¹æ€§ï¼š
- ä½¿ç”¨ BIGSERIAL ä½œä¸ºè‡ªå¢ä¸»é”®
- ä½¿ç”¨ JSONB ç±»å‹å­˜å‚¨å¤æ‚æ•°æ®ï¼ˆæ€§èƒ½æ›´å¥½ï¼‰
- ä½¿ç”¨ TIMESTAMP ç±»å‹å­˜å‚¨æ—¶é—´
- æ”¯æŒå®Œæ•´çš„ SQL æ ‡å‡†

æ³¨æ„äº‹é¡¹ï¼š
- èœå•æ’å…¥ä½¿ç”¨ CTE (WITH è¯­å¥)
- éªŒè¯æŸ¥è¯¢ä¸­ä½¿ç”¨åŒå¼•å·åŒ…è£¹åˆ—åˆ«å

==================================================
ğŸš€ SQLite ä½¿ç”¨æ–¹æ³•
==================================================

æ–¹æ³•ä¸€ï¼šå‘½ä»¤è¡Œ
--------------------------------------------------
cd backend/plugin/approval/sql/sqlite
sqlite3 database.db < init.sql

æ–¹æ³•äºŒï¼šDB Browser for SQLite
--------------------------------------------------
1. æ‰“å¼€ DB Browser for SQLite
2. æ‰“å¼€æˆ–åˆ›å»ºæ•°æ®åº“æ–‡ä»¶
3. æ‰§è¡Œ SQL æ ‡ç­¾é¡µ
4. ç²˜è´´ sqlite/init.sql å†…å®¹
5. ç‚¹å‡»æ‰§è¡Œ

æ–¹æ³•ä¸‰ï¼šPython ä»£ç 
--------------------------------------------------
import sqlite3

conn = sqlite3.connect('database.db')
with open('sql/sqlite/init.sql', 'r', encoding='utf-8') as f:
    sql_script = f.read()
conn.executescript(sql_script)
conn.close()

ç‰¹æ€§ï¼š
- ä½¿ç”¨ INTEGER PRIMARY KEY AUTOINCREMENT
- ä½¿ç”¨ TEXT ç±»å‹å­˜å‚¨ JSONï¼ˆå­˜ä¸ºæ–‡æœ¬ï¼‰
- ä½¿ç”¨ TEXT ç±»å‹å­˜å‚¨æ—¶é—´ï¼ˆISO 8601æ ¼å¼ï¼‰
- å¸ƒå°”å€¼ä½¿ç”¨ INTEGER (0/1)
- è½»é‡çº§ï¼Œé€‚åˆå°å‹åº”ç”¨å’Œæµ‹è¯•

æ³¨æ„äº‹é¡¹ï¼š
- å¤–é”®çº¦æŸé»˜è®¤å…³é—­ï¼Œéœ€è¦ PRAGMA foreign_keys = ON
- æ—¶é—´ä½¿ç”¨ datetime('now') å‡½æ•°
- JSON å­˜å‚¨ä¸ºæ–‡æœ¬ï¼Œéœ€è¦åº”ç”¨å±‚è§£æ

==================================================
ğŸ“Š æ•°æ®ç±»å‹å¯¹ç…§è¡¨
==================================================

å­—æ®µç±»å‹      | MySQL        | PostgreSQL  | SQLite
--------------------------------------------------------
ä¸»é”®ID        | BIGINT AUTO  | BIGSERIAL   | INTEGER AUTO
æ–‡æœ¬(çŸ­)      | VARCHAR(n)   | VARCHAR(n)  | TEXT
æ–‡æœ¬(é•¿)      | TEXT         | TEXT        | TEXT
æ•´æ•°          | INT/BIGINT   | INTEGER     | INTEGER
å°æ•°          | FLOAT        | FLOAT       | REAL
å¸ƒå°”          | BOOLEAN      | BOOLEAN     | INTEGER (0/1)
JSON          | JSON         | JSONB       | TEXT
æ—¶é—´æˆ³        | TIMESTAMP    | TIMESTAMP   | TEXT
å”¯ä¸€çº¦æŸ      | UNIQUE       | UNIQUE      | UNIQUE

==================================================
âœ… ä¸‰ç§æ•°æ®åº“å…±åŒç‰¹æ€§
==================================================

âœ“ 6å¼ æ ¸å¿ƒè¡¨
  - approval_flow (æµç¨‹å®šä¹‰)
  - approval_flow_node (æµç¨‹èŠ‚ç‚¹)
  - approval_flow_line (æµç¨‹è¿çº¿)
  - approval_instance (æµç¨‹å®ä¾‹)
  - approval_step (æµç¨‹æ­¥éª¤ï¼ŒåŒ…å«node_noå­—æ®µ)
  - approval_opinion (å®¡æ‰¹æ„è§)

âœ“ 10æ¡ä¾§è¾¹æ èœå•
  - 1ä¸ªä¸»èœå•ï¼šå®¡æ‰¹æµ
  - 4ä¸ªå¯è§å­èœå•
  - 5ä¸ªéšè—èœå•

âœ“ è‡ªåŠ¨éªŒè¯
  - è¡¨æ•°é‡æ£€æŸ¥ï¼ˆåº”ä¸º6ï¼‰
  - èœå•æ•°é‡æ£€æŸ¥ï¼ˆåº”ä¸º10ï¼‰
  - èœå•åˆ—è¡¨å±•ç¤º

âœ“ å®Œæ•´ç´¢å¼•
  - å¤–é”®å­—æ®µç´¢å¼•
  - çŠ¶æ€å­—æ®µç´¢å¼•
  - ä¸šåŠ¡ç¼–å·ç´¢å¼•

==================================================
ğŸ” éªŒè¯å®‰è£…
==================================================

MySQL:
--------------------------------------------------
-- æ£€æŸ¥è¡¨
SHOW TABLES LIKE 'approval_%';

-- æ£€æŸ¥èœå•
SELECT COUNT(*) FROM sys_menu 
WHERE title = 'å®¡æ‰¹æµ' 
OR parent_id IN (SELECT id FROM sys_menu WHERE title = 'å®¡æ‰¹æµ');

PostgreSQL:
--------------------------------------------------
-- æ£€æŸ¥è¡¨
SELECT tablename FROM pg_tables 
WHERE tablename LIKE 'approval_%';

-- æ£€æŸ¥èœå•
SELECT COUNT(*) FROM sys_menu 
WHERE title = 'å®¡æ‰¹æµ' 
OR parent_id IN (SELECT id FROM sys_menu WHERE title = 'å®¡æ‰¹æµ');

SQLite:
--------------------------------------------------
-- æ£€æŸ¥è¡¨
SELECT name FROM sqlite_master 
WHERE type='table' AND name LIKE 'approval_%';

-- æ£€æŸ¥èœå•
SELECT COUNT(*) FROM sys_menu 
WHERE title = 'å®¡æ‰¹æµ' 
OR parent_id IN (SELECT id FROM sys_menu WHERE title = 'å®¡æ‰¹æµ');

==================================================
âš ï¸ æ³¨æ„äº‹é¡¹
==================================================

1. å­—ç¬¦ç¼–ç 
   MySQL: ä½¿ç”¨ utf8mb4
   PostgreSQL: é»˜è®¤ UTF8
   SQLite: é»˜è®¤ UTF8

2. JSON å¤„ç†
   MySQL: JSON ç±»å‹ï¼Œå¯ç”¨ JSON å‡½æ•°
   PostgreSQL: JSONB ç±»å‹ï¼ˆæ¨èï¼‰ï¼Œæ”¯æŒç´¢å¼•
   SQLite: TEXT ç±»å‹ï¼Œåº”ç”¨å±‚è§£æ

3. æ—¶é—´å¤„ç†
   MySQL: TIMESTAMP è‡ªåŠ¨æ›´æ–°
   PostgreSQL: TIMESTAMP éœ€æ‰‹åŠ¨æ›´æ–°æˆ–è§¦å‘å™¨
   SQLite: TEXT æ ¼å¼ï¼Œä½¿ç”¨ datetime å‡½æ•°

4. å¸ƒå°”å€¼
   MySQL: BOOLEAN (å®é™…ä¸ºTINYINT)
   PostgreSQL: BOOLEAN åŸç”Ÿç±»å‹
   SQLite: INTEGER (0=false, 1=true)

5. äº‹åŠ¡æ”¯æŒ
   MySQL: æ”¯æŒ (InnoDBå¼•æ“)
   PostgreSQL: å®Œæ•´æ”¯æŒ
   SQLite: å®Œæ•´æ”¯æŒï¼Œä½†æ³¨æ„é”æœºåˆ¶

==================================================
ğŸ”„ è¿ç§»å»ºè®®
==================================================

ä» MySQL è¿ç§»åˆ° PostgreSQL:
--------------------------------------------------
1. æ•°æ®ç±»å‹åŸºæœ¬å…¼å®¹
2. JSON â†’ JSONB (æ€§èƒ½æ›´å¥½)
3. AUTO_INCREMENT â†’ SERIAL
4. æ³¨æ„å¤§å°å†™æ•æ„Ÿæ€§

ä» MySQL è¿ç§»åˆ° SQLite:
--------------------------------------------------
1. BIGINT â†’ INTEGER
2. JSON â†’ TEXT (éœ€åº”ç”¨å±‚è§£æ)
3. TIMESTAMP â†’ TEXT
4. BOOLEAN â†’ INTEGER
5. æ³¨æ„å¤–é”®çº¦æŸé»˜è®¤å…³é—­

ä» SQLite è¿ç§»åˆ° MySQL/PostgreSQL:
--------------------------------------------------
1. INTEGER â†’ BIGINT/BIGSERIAL
2. TEXT (JSON) â†’ JSON/JSONB
3. TEXT (datetime) â†’ TIMESTAMP
4. æ·»åŠ å­—ç¬¦ç¼–ç è®¾ç½®

==================================================
ğŸ“ é—®é¢˜æ’æŸ¥
==================================================

é—®é¢˜1ï¼šè¡¨åˆ›å»ºå¤±è´¥
--------------------------------------------------
æ£€æŸ¥ï¼š
- æ•°æ®åº“ç‰ˆæœ¬æ˜¯å¦ç¬¦åˆè¦æ±‚
- æƒé™æ˜¯å¦è¶³å¤Ÿ
- è¯­æ³•æ˜¯å¦å…¼å®¹å½“å‰æ•°æ®åº“

é—®é¢˜2ï¼šèœå•ä¸æ˜¾ç¤º
--------------------------------------------------
æ£€æŸ¥ï¼š
- sys_menu è¡¨æ˜¯å¦å­˜åœ¨
- component å­—æ®µå€¼æ˜¯å¦æ­£ç¡®
- æ˜¯å¦æ¸…é™¤ç¼“å­˜å¹¶é‡æ–°ç™»å½•

é—®é¢˜3ï¼šJSON å­—æ®µæŠ¥é”™
--------------------------------------------------
MySQL: ç¡®è®¤ç‰ˆæœ¬ >= 5.7
PostgreSQL: ä½¿ç”¨ JSONB æ›¿ä»£ JSON
SQLite: JSONå­˜ä¸ºTEXTï¼Œåº”ç”¨å±‚å¤„ç†

é—®é¢˜4ï¼šå­—ç¬¦é›†é—®é¢˜
--------------------------------------------------
MySQL: ç¡®è®¤è¡¨ä½¿ç”¨ utf8mb4
PostgreSQL: æ£€æŸ¥æ•°æ®åº“ç¼–ç 
SQLite: ä¸€èˆ¬æ— é—®é¢˜

==================================================
ğŸ“š æ¨èå·¥å…·
==================================================

MySQL:
- Navicat
- MySQL Workbench
- phpMyAdmin
- DBeaver

PostgreSQL:
- pgAdmin
- DBeaver
- DataGrip
- Postico (macOS)

SQLite:
- DB Browser for SQLite
- SQLiteStudio
- DBeaver
- å‘½ä»¤è¡Œ sqlite3

é€šç”¨å·¥å…·:
- DBeaver (æ”¯æŒæ‰€æœ‰æ•°æ®åº“)
- DataGrip (JetBrains)
- TablePlus

==================================================
ç‰ˆæœ¬ä¿¡æ¯
==================================================

è„šæœ¬ç‰ˆæœ¬: v2.0
åˆ›å»ºæ—¥æœŸ: 2025-11-19
æ”¯æŒæ•°æ®åº“: MySQL / PostgreSQL / SQLite

æ›´æ–°å†…å®¹:
- âœ… æ”¯æŒä¸‰ç§ä¸»æµæ•°æ®åº“
- âœ… approval_step è¡¨åŒ…å« node_no å­—æ®µ
- âœ… å®Œæ•´çš„10ä¸ªèœå•é¡¹é…ç½®
- âœ… è‡ªåŠ¨éªŒè¯å®‰è£…ç»“æœ
- âœ… ä¼˜åŒ–ç´¢å¼•å’Œçº¦æŸ

==================================================
